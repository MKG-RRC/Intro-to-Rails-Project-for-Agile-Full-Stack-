<div class="container py-4">
  <h1 class="fw-bold mb-4">Programs</h1>

  <!-- ðŸ” Search + Filter Form -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <%= form_with url: programs_path, method: :get, local: true, class: "row g-2 align-items-end" do %>
        <!-- Search Field -->
        <div class="col-md-4">
          <%= label_tag :q, "Search Programs", class: "form-label fw-semibold" %>
          <%= text_field_tag :q, params[:q], placeholder: "Enter program name or keyword", class: "form-control" %>
        </div>

        <!-- University Dropdown (Hierarchical Filter) -->
        <div class="col-md-4">
          <%= label_tag :university_id, "Filter by University", class: "form-label fw-semibold" %>
          <%= select_tag :university_id,
              options_from_collection_for_select(@universities, :id, :name, params[:university_id]),
              include_blank: "All Universities",
              class: "form-select" %>
        </div>

        <!-- Buttons -->
        <div class="col-md-2">
          <%= submit_tag "Filter", class: "btn btn-dark w-100" %>
        </div>
        <div class="col-md-2">
          <%= link_to "Clear", programs_path, class: "btn btn-outline-secondary w-100" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- ðŸ“‹ Programs Table -->
  <table class="table table-striped table-hover align-middle shadow-sm">
    <thead class="table-dark text-light">
      <tr>
        <th>Name</th>
        <th>Description</th>
        <th>University</th>
        <th class="text-end">Actions</th>
      </tr>
    </thead>

    <tbody>
      <% if @programs.any? %>
        <% @programs.each do |p| %>
          <tr>
            <td><%= link_to p.name, p, class: "fw-semibold text-decoration-none" %></td>
            <td><%= truncate(p.description, length: 80) %></td>
            <td><%= link_to p.university.name, p.university, class: "text-decoration-none" %></td>
            <td class="text-end">
              <%= link_to "Edit", edit_program_path(p), class: "btn btn-sm btn-outline-secondary" %>
              <%= link_to "Delete", p, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-sm btn-danger" %>
            </td>
          </tr>
        <% end %>
      <% else %>
        <tr>
          <td colspan="4" class="text-center text-muted py-3">No programs found.</td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <!-- ðŸ”¢ Pagination -->
  <div class="d-flex justify-content-center mt-4">
    <%= paginate @programs %>
  </div>

  <!-- âž• New Program Button -->
  <div class="mt-4">
    <%= link_to "New Program", new_program_path, class: "btn btn-primary" %>
  </div>
</div>
